--- before.c
+++ after.c
@@ -87,31 +87,32 @@
 int evaluate(int *start, int *end) {
-    if (*start > *end) {
+    if (*start >= *end) {
       return 0;
     }

     int i = *start;
     while (i <= *end && tokens[i].type != TOKEN_LPAREN) {
       i++;
     }

     int left = evaluate(start, &i);
     while (i <= *end) {
-      TokenType operator = tokens[i++].type;
+      if (i > *end) break;
       TokenType operator = tokens[i++].type;
       int right = evaluate(&i, end);

-      if (operator == TOKEN_MINUS && i > *end) {
+      if (operator == TOKEN_MINUS && i > *end) {
         return apply_operator(left, -right, operator);
       }

-      left = apply_operator(left, right, operator);
+      left = apply_operator(left, right, operator);
     }

     return left;
 }
