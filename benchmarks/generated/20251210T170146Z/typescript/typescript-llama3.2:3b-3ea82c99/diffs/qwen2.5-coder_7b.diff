--- before.ts
+++ before.ts
@@ -27,7 +27,7 @@ interface Token {
   value: number | string;
 }
 
-class ExpressionEvaluator {
+class ExpressionEvaluator {
   private tokens: Token[];
 
   constructor(input: string) {
@@ -70,7 +70,7 @@ class ExpressionEvaluator {
     for (const char of input) {
       if (char.match(/^[0-9]+$/)) {
         currentNumber += char;
-      } else {
+      } else if (char === '+' || char === '-' || char === '*' || char === '/' || char === '(' || char === ')') {
         if (currentNumber !== '') {
           output.push({ type: 'NUMBER', value: parseInt(currentNumber, 10) });
           currentNumber = '';
@@ -73,7 +73,7 @@ class ExpressionEvaluator {
     }
     if (currentNumber !== '') {
       output.push({ type: 'NUMBER', value: parseInt(currentNumber, 10) });
-    }
+    }

     return output;
   }
@@ -86,7 +86,7 @@ class ExpressionEvaluator {
     for (const token of tokens) {
       if (token.type === 'NUMBER') {
         currentNumber += token.value.toString();
-      } else {
+      } else if (token.type === 'PLUS' || token.type === 'MINUS' || token.type === 'MUL' || token.type === 'DIV' || token.type === 'LPAREN' || token.type === 'RPAREN') {
         if (currentNumber !== '') {
           output.push(parseInt(currentNumber, 10));
           currentNumber = '';
@@ -87,7 +87,7 @@ class ExpressionEvaluator {
       const precedence = this.getPrecedence(token.type);
       let left: number[] | null = null;
       let right: number[] | null = null;

-      switch (token.type) {
+      switch (token.type as 'PLUS' | 'MINUS' | 'MUL' | 'DIV' | 'LPAREN' | 'RPAREN') {
         case 'LPAREN':
           if (output.length > 0 && output[output.length - 1] !== '(') {
             throw new Error('Malformed expression');
@@ -89,7 +89,7 @@ class ExpressionEvaluator {
           left = this.parse(output);
           break;
         case 'RPAREN':
-          if (!left || output[output.length - 1] !== ')') {
+          if (!left || output[output.length - 1] !== '(') {
             throw new Error('Malformed expression');
           }
           right = this.parse(output.slice(0, output.length - 1));
@@ -92,7 +92,7 @@ class ExpressionEvaluator {
         default:
-          if (right) {
+          if (right || token.type === 'PLUS' || token.type === 'MINUS' || token.type === 'MUL' || token.type === 'DIV') {
             throw new Error('Malformed expression');
           }

           const operatorIndex = output.indexOf(token);
@@ -95,7 +95,7 @@ class ExpressionEvaluator {
           left = this.parse(output.slice(0, operatorIndex));
           right = this.parse(output.slice(operatorIndex + 1));
       }

-      output.push(left!.reduce((a, b) => a * b, 1));
+      output.push(left![output.length - 1]);
     }
   }

@@ -129,7 +129,7 @@ export function evaluateExpression(input: string): number {
   try {
     return evaluator.evaluateExpression();
   } catch (error) {
-    console.error(error.message);
+    console.error((error as Error).message);
     return NaN;
   }
 }
